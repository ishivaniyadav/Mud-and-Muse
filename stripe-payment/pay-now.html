<script>
  const cart = JSON.parse(localStorage.getItem("cart"));

  if (!cart || cart.length === 0) {
    alert("Cart is empty");
    window.location.href = "../index.html";
  } else {
    fetch("/create-checkout-session", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ cartItems: cart })
    })
    .then(res => res.json())
    .then(data => {
      if (data.url) {
        window.location.href = data.url;
      } else {
        alert("Payment failed");
      }
    })
    .catch(err => {
      console.error(err);
      alert("Stripe error");
    });
  }
</script>
